import numpy as np
import pandas as pd

pd.set_option('display.max_columns', None)
pd.options.mode.chained_assignment = None

# Create the covid_state_dataset.

ny_state_population = 19_453_734

# This list contains the total cases so far.
total_cases = [328,421,528,740,975,1717,3060,5402,8455,10449,15891,21016,26534,33211,39311,46694,53947,61363,68151,76978,85085,94442,105075,116586,125067,134206,144925,153929,164467,175517,184490,192952,199374,206991,218657,226296,234052,241145,247322,252203,256666,262381,268697,277565,288438,294118,298133,301580,306290,310973,315358,319351,324023,327515,330281,333634,337566,340875,344210,346628,348824,350449,353245,356182,359940,362795,364767,367002,368803,370854,373550,375713,377369,379170,380562,382014,383195,385196,387138,388790,390073,391244,392691,393810,395408,396873,397984,399002,400066,400834,401664,402509,403559,404611,405429,406255,407058,407797,408600,409767,410608,411438,412146,412810,413529,414448,415381,416192,416961,417502,418010,418779,419814,420948,421811,422442,423025,423667,424437,425246,426190,426981,427812,428477,429452,430451,431554,432586,433488,434338,435045,435927,436750,437703,438609,439454,440059,440840,441436,442234,443174,444098,444853,445320,446015,446865,447553,448342,449165,450002,450606,451199,451910,452683,453506,454322,455113,455772,456292,457010,457774,458453,459270,459971,460634,461165,461792,462468,463369,464089,464769,465549,466292,467623,468405,469390,470636,471443,472185,472743,473755,474384,475211,476197,477066,477782,478555,479360,480083,481075,481964,482997,483880,484612,485394,486112,487155,488139,489146,490040,491036,492234,493332,494785,496493,498214,499442,500596,502006,503473,505414,507075,508501,509646,510796,512339,513648,515213,516942,518732,520186,521408,522707,524768,526477,528263,530258,531847,533264,535321,537406,539996,542298,544275,546452,548275,550704,552863,555920,559161,562577,565929,569508,573465,578076,583133,588605,593767,597394,601457,606624,611988,617741,623242,628808,634035,640356,645834,651830,658637,666642,672393,679111,686446,694060,703443,713587,724437,734600,743876,752073,761795,772399,782680,793396,803912,813788,823599,834212,844340,855526,868068,877399,887177,896945,906834,919159,931642,943264,954087,961869,972951,984638,998524,1015573,1029146,1043789,1057162,1069073,1082147,1098899,1116929,1135593,1152214,1167149,1182351,1197391,1212324,1226311,1246488,1261668,1275196,1287593,1301191,1314916,1328973,1344365,1357440,1370149,1383162,1394675,1405906,1419485,1432343,1444854,1455386,1464810,1473172,1479263,1486879,1495835,1506919,1516709,1525710,1534029,1541314,1551628,1560288,1568969,1577219,1583618,1591015,1597308,1604469,1613432,1621041,1627523,1634271,1641112,1647482,1656533,1664958,1673171,1680688,1687443,1693580,1701431,1709285,1718464,1726139,1732927,1738812,1745965,1752585,1759610,1768855,1775443,1781536,1787901,1794501,1803680,1811939,1820272,1827853,1835861,1842631,1849648,1857148,1865527,1874285,1882366,1891806,1899828,1906626,1915254,1924398,1932497,1940390,1947781,1954849,1960669,1968112,1976935,1986098,1993324,2000173,2005471,2010683,2017100,2024251,2030987,2039325,2045065,2049527,2054047,2058675,2063812,2069006,2073275,2077439,2080879,2083832,2087197,2091523,2095597,2099322,2102272,2104840,2107320,2109831,2112795,2115496,2118722,2120959,2122891,2124678,2126667,2129182,2131542,2133236,2135227,2136940,2138099,2139723,2141529,2143288,2144784,2145991,2147244,2148168,2149302,2150604,2151753,2152832,2153721,2154361,2154931,2155473,2156270,2157246,2158162,2158867,2159547,2160110,2160770,2161591,2162294,2163063,2163606,2164099,2164574,2165099,2165748,2166360,2166957,2167381,2167840,2168200,2168705,2169151,2169719,2170294,2170786,2171261,2171689,2172219,2172803,2173633,2174150,2174697,2175160,2175522,2176123,2177003,2178036,2178896,2179748,2180471,2181203,2182172,2183390,2184562,2185947,2187194,2188193,2189474,2191157,2192950,2194974,2197250,2199152,2200720,2202478,2204834,2207762,2210612,2213800,2216457,2218884,2221966,2225227,2229112,2233123,2237522,2241094,2245200,2248609,2252993,2258033,2262835,2267397,2271994,2276084,2279928,2284769,2290347,2295557,2300256,2304303,2308873,2312467,2316759,2322417,2328866,2333885,2339058,2343804,2348223,2352807,2358558,2365088,2370024,2374459,2377995,2381832,2386931,2392645,2398911,2404635,2409785,2414826,2419432,2424888,2431639,2437752,2442600,2447982,2452856,2458407,2463418,2468420,2474724,2479824,2483592,2488753,2493142,2499266,2504530,2510039,2514512,2518841,2522871,2527259,2533113,2538594,2544135,2548558,2551637,2557205,2561624,2567020,2571775,2577676,2582509,2585824,2590887,2594147,2599157,2603658,2607661,2611705,2614549,2617983,2621376,2625812,2630273,2635539,2639380,2643253,2647465,2650546,2654847,2659425,2664185,2668996,2673284,2678101,2682441,2688427,2694071,2701014,2707343,2712085,2718320,2723469,2730282,2737604,2745048,2752145,2757847,2765061,2772410,2779607,2786895,2792680,2797297,2803071,2810593,2817654,2829201,2839439,2851091,2859990,2869656,2878500,2887452,2898251,2909737,2919818,2930727,2941697,2954106,2962349,2977097,2995000,3016444,3037458,3059082,3085475,3107454,3137022,3175341,3220099,3260550,3302107,3333938,3377069,3444295,3515464,3592118,3676970,3737687,3793863,3847456,3928353,4015318,4096075,4181246,4251694,4313376,4369536,4429482,4490898,4549010,4592684,4637773,4665446,4699690,4726416,4755168,4790487,4813820,4832399,4850317,4865397,4887075,4904361,4919387,4929511,4936420,4945687,4954148,4964219,4974030,4982929,4989404,4994926,4999994,5005800,5012534,5020179,5025568,5028963,5032117,5035847,5038547,5042417,5046111,5050980,5053517,5055555,5057779,5060174,5062860,5065555,5067935,5069752,5071336,5073335,5075270,5077258,5079805,5082135,5084327,5085635,5087314,5088520,5090349,5092228,5094420,5095963,5097565,5099130,5102435,5104412,5106739,5108882,5111261,5113162,5115045,5117069,5120756,5124391,5127946,5130627,5133092,5136201,5139058,5142462,5147268,5151110,5154409,5157785,5161168,5164346,5168708,5176049,5181668,5186180,5191215,5197371,5202104,5208689,5216787,5223409,5230029,5234714,5241618,5247037,5254321,5261340,5270040,5274496,5279289,5287297,5293816,5301663,5311586,5320062,5326360,5332236,5340826,5348040,5356911,5367771,5381747,5389691,5398251,5409058,5415424,5425897,5440227,5451816,5460157,5467264,5478364,5486463,5498281,5509573,5520079,5528174,5535572,5544874,5551613,5560244,5570726,5580624,5589208,5596424,5601669,5605846,5612740,5619751,5629274,5635555,5641291,5646945,5651585,5659140,5665872,5671552,5677051,5681025,5688836,5692808,5697734,5703892,5709698,5714275,5718962,5722759,5728293]

# This list contains the new cases per day.
new_cases = [total_cases[i] - total_cases[i - 1] for i in range(1, len(total_cases))]
new_cases.insert(0, total_cases[0])

# This list contains the active cases.
active_cases = [328,421,524,729,956,1692,3018,5334,8355,10320,15682,20618,25979,32505,37010,43630,49806,56069,61702,69326,75574,83119,91697,100778,106721,113844,122371,128947,138266,148347,155910,163014,168585,175277,179256,186288,193018,199571,205120,209369,207361,212414,218223,225036,235291,240604,229932,231452,234622,237767,240701,244395,246563,249205,251325,253058,255631,257831,260196,260177,261416,262138,263679,264855,267038,268250,269781,270277,270992,272166,274023,275249,276712,277562,278212,278861,279469,280523,281602,282306,282937,283526,284136,283822,284335,281743,282556,283250,284096,284630,285016,285451,286073,286733,287113,287651,288121,288509,290024,290987,291684,292473,292924,293542,294215,294743,295452,295463,295821,296329,296383,296135,292869,289701,284170,275003,268249,261970,252896,244310,236268,227543,217878,209185,200787,192803,185473,177568,170538,163280,157183,152127,146670,140859,135865,130972,125722,120043,112173,109422,107140,103511,99733,95687,92549,89570,87195,84643,82865,83693,81048,77854,75351,72877,71592,70877,70484,69230,67849,66941,66462,66014,65433,65048,64164,63241,62790,62491,62370,62343,62213,62187,61900,62204,62187,62356,62803,62896,62855,62194,62446,62260,62399,62740,62915,62744,62589,62581,62562,63023,63432,63717,63575,63187,63121,63217,63690,64035,64310,64395,64447,64860,65133,65912,66639,67378,67504,67617,68120,68724,69958,70739,71342,71537,71778,72473,73161,73940,75080,76070,76581,76865,77408,78958,80009,80934,82237,83028,83620,84837,86302,88285,89871,91069,92415,93418,95053,96529,99049,101569,104212,106871,109612,112841,116786,121293,126113,130583,133114,136428,140890,145441,150420,155865,159314,163557,168596,173235,178458,184666,191616,196707,202567,208851,215532,224115,233413,243414,252820,261080,268279,276897,286577,296048,305911,315640,324394,333107,342589,351723,361769,373015,381178,389418,397314,405339,416308,427517,437628,446895,452632,461891,472004,484567,500347,512263,525517,537213,547215,558361,573500,590059,607034,621745,634842,648058,660915,674120,686452,704401,717365,728128,738865,749510,760854,772885,785582,796478,806004,815586,823493,831262,841064,849812,857604,862965,866775,869824,872148,875623,879325,884910,888852,892256,894882,896822,900794,903858,906495,907911,906265,907851,907424,907157,908473,906757,903115,898984,895633,892779,893675,892403,890042,887287,883307,878952,876954,875029,873686,871285,866941,860322,858185,855109,852410,851865,846305,839966,834780,830604,832152,829442,826175,820073,811207,804532,796979,791112,787718,783578,775060,766609,755983,746277,740100,733966,727303,720405,713930,703391,691642,685652,682212,677910,671493,664368,654427,646666,640439,634685,630009,627211,619508,611208,603257,597432,593224,590123,588466,585116,579660,571514,565185,560561,556404,551402,545625,539567,533359,527718,524343,519756,516761,511907,504921,499125,494642,490447,486048,481481,474457,467796,460796,454961,450101,445753,439482,432898,424982,418219,412573,408101,402225,396751,390664,382122,376156,370717,365192,359595,351460,343954,336343,329395,322125,316204,309961,303275,295506,287286,279745,270906,263570,257465,249489,240831,233248,225737,218887,212344,207126,200314,192026,183379,176614,170330,165719,161347,155512,148946,142713,134765,129687,126186,122737,118997,114743,110312,106799,103647,101475,99747,97800,94744,91668,89252,88013,87273,86833,86606,85571,84433,82980,83139,84155,85233,86444,86606,86674,88067,89340,91533,94387,97165,98946,101283,103208,106416,110178,114030,117486,120774,123711,126456,130418,135347,139962,144117,147358,150935,153528,157174,162134,167998,173003,176686,180692,184328,188358,193578,199616,204029,207790,210681,213880,218519,223763,229630,234824,239511,243963,247874,252873,259129,264760,269096,273870,277877,282852,287281,291778,297684,302180,305914,309119,312602,317835,322332,327077,330578,333687,336503,339462,344045,348517,352732,355477,356741,360261,362362,365816,368985,373111,375611,375992,378163,378195,380520,382582,383485,384264,383210,382626,381572,382426,382778,384628,383768,382938,382311,380826,380531,380953,381883,381874,380578,380152,379776,381711,383298,386163,388220,387332,387112,387201,388843,391427,394453,396534,396953,397600,400252,402752,406549,408511,408062,408126,409343,410647,417048,422245,429301,432776,435719,438392,442381,447799,454412,458916,464810,470793,476845,479906,490844,503614,520661,535554,551926,572686,590144,615362,649643,690023,730460,760744,786944,825596,889612,955183,1027386,1106807,1162709,1212895,1261582,1339055,1420839,1498197,1578368,1644309,1701819,1753668,1810601,1868449,1922941,1962147,2002752,2024919,2054934,2077564,2101956,2134003,2153016,2166852,2179896]

# This list contains the total deaths so far.
total_deaths = [0,0,3,10,18,24,41,67,100,129,209,290,447,598,784,1019,1415,1722,2140,2677,3369,3889,4492,5330,6159,6996,7974,8967,9967,10936,11903,12849,13700,14625,15514,16121,17147,17687,18315,18947,19712,20374,20881,21311,21929,22296,22644,23165,23495,23801,24090,24389,24669,24965,25225,25979,26388,26608,26794,27277,27521,27937,28103,28278,28434,28607,28799,28955,29124,29235,29363,29488,29592,29712,29918,30060,30163,30264,30363,30442,30532,30603,30694,30781,30899,30991,31020,31061,31136,31222,31299,31360,31443,31493,31530,31571,31617,31665,31711,31778,31793,31834,31887,31933,31965,31992,32040,32071,32103,32135,32152,32166,32189,32214,32238,32271,32290,32315,32334,32366,32398,32415,32426,32468,32485,32518,32541,32558,32575,32593,32607,32625,32640,32679,32688,32702,32712,32731,32742,32757,32777,32788,32796,32803,32814,32824,32834,32840,32845,32854,32863,32870,32880,32897,32910,32918,32924,32933,32943,32955,32957,32960,32960,32973,32990,32995,33003,33010,33017,33028,33035,33044,33053,33062,33075,33082,33088,33090,33095,33114,33123,33127,33132,33132,33139,33139,33151,33164,33179,33186,33191,33193,33200,33204,33206,33211,33216,33225,33229,33238,33252,33256,33269,33289,33310,33313,33323,33340,33352,33376,33386,33394,33400,33402,33414,33426,33449,33464,33474,33489,33500,33520,33530,33545,33559,33572,33579,33588,33603,33623,33644,33666,33678,33691,33710,33721,33733,33766,33792,33808,33824,33844,33873,33899,33921,33949,33978,33999,34020,34056,34081,34126,34159,34209,34236,34256,34294,34333,34368,34411,34459,34495,34535,34604,34677,34751,34852,34909,34963,35008,35120,35201,35257,35349,35444,35523,35610,35730,35856,35968,36124,36245,36330,36425,36604,36758,36906,37036,37152,37255,37372,37541,37698,37891,38030,38165,38267,38391,38584,38741,38911,39172,39321,39470,39615,39831,40039,40207,40471,40664,40823,41027,41187,41403,41643,41871,42097,42235,42411,42628,42838,42986,43223,43411,43562,43724,43902,44093,44302,44453,44614,44850,45002,45152,45324,45489,45656,45830,45970,46092,46211,46358,46480,46699,46844,46942,47043,47157,47281,47408,47520,47643,47743,47850,47972,48065,48207,48332,48433,48521,48602,48666,48749,48860,48973,49044,49128,49226,49304,49402,49467,49562,49643,49704,49722,49753,49884,50038,50116,50180,50255,50342,50464,50523,50610,50692,50766,50853,50928,51013,51060,51143,51200,51276,51345,51423,51506,51556,51641,51705,51769,51841,51879,51923,52005,52045,52113,52168,52222,52265,52303,52419,52437,52505,52549,52594,52639,52705,52791,52843,52876,52909,52962,52993,53036,53091,53145,53187,53219,53223,53258,53291,53335,53355,53364,53399,53410,53428,53479,53509,53532,53552,53578,53589,53604,53616,53651,53661,53677,53706,53714,53740,53785,53790,53797,53816,53828,53840,53849,53873,53886,53893,53906,53910,53919,53921,53936,53952,53958,53963,53969,53981,53993,54006,54016,54019,54032,54040,54043,54049,54054,54071,54076,54081,54089,54100,54102,54106,54114,54121,54127,54128,54137,54146,54151,54158,54163,54172,54176,54177,54185,54201,54204,54215,54225,54232,54241,54247,54257,54267,54275,54290,54298,54311,54325,54339,54357,54371,54401,54416,54425,54444,54460,54489,54503,54525,54535,54572,54585,54611,54633,54654,54688,54716,54730,54750,54799,54825,54849,54897,54917,54928,54961,54997,55044,55085,55113,55157,55187,55212,55244,55289,55330,55363,55399,55412,55437,55483,55551,55591,55640,55681,55693,55727,55775,55829,55884,55931,55974,55987,55996,56047,56097,56131,56151,56204,56214,56244,56281,56337,56391,56427,56458,56465,56486,56537,56596,56640,56681,56713,56739,56762,56806,56867,56903,56928,56956,56976,56998,57049,57073,57121,57186,57223,57250,57276,57320,57370,57410,57429,57469,57477,57493,57529,57595,57625,57662,57702,57718,57735,57785,57832,57879,57902,57928,57944,57981,58032,58099,58143,58197,58242,58257,58272,58343,58467,58517,58566,58626,58650,58688,58751,58863,58942,58970,59032,59065,59084,59215,59284,59356,59423,59457,59471,59482,59598,59677,59852,59943,60011,60071,60159,60268,60363,60523,60665,60852,60907,60950,61146,61439,61652,61836,62103,62154,62217,62465,62869,63128,63342,63563,63619,63824,63954]

# This list contains the new deaths per day.
new_deaths = [total_deaths[i] - total_deaths[i - 1] for i in range(1, len(total_deaths))]
new_deaths.insert(0, total_deaths[0])

# This list contains the total number of recovered people.
total_recovered = [total_cases[i] - active_cases[i] - total_deaths[i] for i in range(len(total_cases))]

# This list contains the number of recovered people per day.
new_recoveries = [total_recovered[i] - total_recovered[i - 1] for i in range(1, len(total_recovered))]
new_recoveries.insert(0, total_recovered[0])

# This list contains the average recovery rate till the current day.
recovery_rate = [total_recovered[i] * 100 / total_cases[i] for i in range(len(total_cases))]

# This list contains the average death rate till the current day.
death_rate = [total_deaths[i] * 100 / total_cases[i] for i in range(len(total_cases))]

# The list contains the percentage of cases that don't have an outcome yet.
no_outcome = [active_cases[i] * 100 / total_cases[i] for i in range(len(total_cases))]

# This list contains the daily recovery rate.
daily_recovery_rate = [new_recoveries[i] * 100 / (active_cases[i - 1]) for i in range(len(total_cases))]

# This list contains the daily death rate.
daily_death_rate = [new_deaths[i] * 100 / (active_cases[i - 1]) for i in range(len(total_cases))]

# This list contains the seven-day daily average recovery rate.
weekly_average_recovery_rate = [np.mean(daily_recovery_rate[i-6:i+1])
                                for i in range(len(total_cases))]

# This list contains the seven-day daily average death rate.
weekly_average_death_rate = [np.mean(daily_death_rate[i-6:i+1])
                             for i in range(len(total_cases))]

# This list contains the daily infection rate.
infection_rate = [new_cases[i] * 100 / active_cases[i - 1] for i in range(len(total_cases))]

covid = pd.DataFrame(data=list(zip(new_cases, active_cases, total_cases, new_recoveries, total_recovered, new_deaths,
                                   total_deaths, daily_recovery_rate, daily_death_rate, weekly_average_recovery_rate,
                                   weekly_average_death_rate, recovery_rate, death_rate, no_outcome, infection_rate)),
                     index=pd.date_range(start='3/12/2020', end='06/21/2022'),
                     columns=['New Cases', 'Active Cases', 'Total Cases', 'New Recoveries', 'Total Recovered',
                              'New Deaths', 'Total Deaths', 'Daily Recovery Rate (%)', 'Daily Death Rate (%)',
                              'Weekly Average Daily Recovery Rate (%)', 'Weekly Average Daily Death Rate(%)',
                              'Recovery Rate so Far(%)', 'Death Rate so Far (%)', 'No Outcome (%)',
                              'Daily Infection Rate'])
covid.index.name = 'date'
print(covid.head())
covid.to_csv('./covid_ny.csv')
